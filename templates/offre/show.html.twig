{# templates/offre/show.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Détails de l’offre{% endblock %}

{% block body %}
  <h1>{{ offre.titre }}</h1>

  {% for label, messages in app.flashes %}
    <div class="alert alert-{{ label }}">
      {% for message in messages %}
        {{ message }}
      {% endfor %}
    </div>
  {% endfor %}

  <ul>
      <li><strong>Description :</strong> {{ offre.description }}</li>
      <li><strong>Lieu :</strong> {{ offre.lieu }}</li>
      <li><strong>Type de contrat :</strong> {{ offre.typeContrat }}</li>
      <li><strong>Salaire :</strong> {{ offre.salaire }} €</li>
      <li><strong>Publiée le :</strong> {{ offre.datePublication|date('Y-m-d H:i') }}</li>
  </ul>

  {% if is_granted('ROLE_USER') %}
    <form method="post"
          action="{{ path('offre_postuler', {'id': offre.id}) }}"
          onsubmit="return confirm('Confirmez-vous votre candidature ?');">
        <input type="hidden" name="_token"
               value="{{ csrf_token('postuler' ~ offre.id) }}">
        <button class="btn btn-primary mb-3">Postuler à cette offre</button>
    </form>
  {% else %}
    <p>
      <a href="{{ path('app_login') }}" class="btn btn-secondary mb-3">
          Connectez-vous pour postuler
      </a>
    </p>
  {% endif %}

  <a href="{{ path('offre_edit', {'id': offre.id}) }}" class="btn btn-warning">Modifier</a>
  <a href="{{ path('offre_index') }}" class="btn btn-secondary">Retour à la liste</a>
{% endblock %}
